<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProVita</title>
    <link rel="stylesheet" href="{{url_for('static', filename='css/style.css')}}"/>


</head>
<body>

<header id="home" class="header">
    <nav class="nav" role="navigation">
        <div class="container nav-elements">
            <div class="branding">
                <a href="/"><img src='static/images/provita_logo.png'
                                 alt="Logo - ProVita" width="100" height="100"></a>

            </div>
            <div class="navbar">
                {% if current_user.is_authenticated %}
                <a class="nav-item nav-link" id="homepage" href="/"> Homepage</a>
                <a class="nav-item nav-link" id="profile" href="/profile">My Profile</a>
                <a class="nav-item nav-link" href="/orders" id="orders">My Orders</a>
                <a class="nav-item nav-link" id="logout" href="/logout">Logout</a>
                <a class="nav-item nav-link" id="admin" href="/admin">Admin Only</a>
                {% else %}
                <a class="nav-item nav-link" id="login" href="/login">Login</a>
                <a class="nav-item nav-link" id="signup" href="/signup">Sign Up</a>
                <a href="https://www.linkedin.com/provita?_l=en_US">LinkedIn</a>
                {% endif %}
            </div>
        </div>
    </nav>
</header>

<section id="search" class="section">
    <header class="imageheader"></header>
    <div class="container">
        <h2 class="headline">Search Products</h2>
        <form action="searchAction" method="get">
            <label class="card-title">Search your product</label>
            <input type="search" name="searchString" id="searchString">
            <input type="submit" value="Search">
        </form>
    </div>
</section>

<section id="addToCart" class="section">
    <div class="container">
<!--        Return the result of the search-->
        <h2 class="headline">Search Results</h2>
<!--        Return the search input-->
        <p> Search Input: {{ searchInput|e }} </p>
    <table>
        <thead>
        <tr>
            <th>Product</th>
            <th>Image</th>
            <th>Price â‚¬</th>
            <th>Quantity</th>
            <th></th>

        </tr>
        </thead>
        <tbody>
        {% for row in products %}
        <tr>
            <!--Encoding data output: By adding the '|e' to escape the user created values. -->
            <!--This way the user inputs will be considered text by the browser-->
            <td>{{ row[1] |e}}</td>
            <td><img src="{{ row[2] }}" alt="{{ row[2] }}" width="150"></td>
            <td>{{ row[3] |e}}</td>
            <td>
                <select name="quantity">
					<option value="1"> 1</option>
					<option value="2"> 2</option>
                    <option value="3"> 3</option>
                    <option value="4"> 4</option>
                </select>
            <td>
                <button onclick="sendData(this)">Add to Cart</button>
            </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
 </div>
</section>

<!-- JavaScript to send the selected product data to "checkout.html" when the button is clicked-->
<script>
function sendData(button) {
 var row = button.parentNode.parentNode;
  var productName = row.cells[0].innerText;
  var image = row.cells[1].querySelector("img").getAttribute("src");
  var quantity = row.cells[3].querySelector("select[name='quantity']").value;
  var price = row.cells[2].innerText;
  var url = "{{ url_for('checkout') }}?product_name=" + encodeURIComponent(productName) + "&image=" + encodeURIComponent(image) + "&price=" + encodeURIComponent(price) + "&quantity=" + encodeURIComponent(quantity);
  window.location.href = url;
}
</script>
</section>

<footer>
    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <h3>About ProVita</h3>
                <p>ProVita provides high-quality healthy products for active lifestyles. Our products are made with
                    natural ingredients and are designed to help you stay fit and healthy.</p>
            </div>
        </div>
    </div>
    <div class="bottom-bar">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <small>&copy; 2023 ProVita. All Rights Reserved.</small>
                </div>
            </div>
        </div>
    </div>

</footer>

</body>
</html>